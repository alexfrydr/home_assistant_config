# -----------------------------------------------------------
# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–º –¥—ã–º–∞
# -----------------------------------------------------------

- alias: "013_Smoke_Detector_Alarm_ON"
  description: "–û–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –¥—ã–º–∞"
  trigger:
    entity_id: binary_sensor.honeywell_detector_smoke
    platform: state
    to: 'on'
  condition: []
  action:
    - repeat:
        while:
          - condition: state
            entity_id: binary_sensor.honeywell_detector_smoke
            state: 'on'
        sequence:
          - service: telegram_bot.send_message
            data:
              title: "üéâ *–°–æ–æ–±—â–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã*" 
              message: |
                   ‚ö†  –í–Ω–∏–º–∞–Ω–∏–µ! –î–∞—Ç—á–∏–∫ –æ–±–Ω–∞—Ä—É–∂–∏–ª –¥—ã–º! 
          - service: script.turn_on
            entity_id: 
                - script.yandex_tts8
          - delay: 00:00:05
          - service: telegram_bot.delete_message
            data:
              chat_id: !secret telegram_bot_allowed_chat_id1
              message_id: last
          - delay: 00:00:05

- alias: "013_Smoke_Detector_Alarm_OFF"
  description: "–û–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–∏ –¥—ã–º–∞"
  trigger:
    entity_id: binary_sensor.honeywell_detector_smoke
    platform: state
    to: 'off'
  condition: []
  action:
  - service: telegram_bot.send_message
    data_template:
        title: "üéâ *–°–æ–æ–±—â–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã*" 
        message: | 
             ‚ö†  –í–Ω–∏–º–∞–Ω–∏–µ! –ò—Å—Ç–æ—á–Ω–∏–∫ –¥—ã–º–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω!
  - delay: 00:00:05
  - service: telegram_bot.delete_message
    data:
      chat_id: !secret telegram_bot_allowed_chat_id1
      message_id: last
     
